{"errors": [], "interfile_languages_used": [], "paths": {"scanned": ["/Users/ibrahim/Developer/unifonic/DataBug/tmp/NodeGoat/Gruntfile.js", "/Users/ibrahim/Developer/unifonic/DataBug/tmp/NodeGoat/app/assets/js/chart/chart-data-morris.js", "/Users/ibrahim/Developer/unifonic/DataBug/tmp/NodeGoat/app/assets/js/tour/redirects-steps.js", "/Users/ibrahim/Developer/unifonic/DataBug/tmp/NodeGoat/app/data/allocations-dao.js", "/Users/ibrahim/Developer/unifonic/DataBug/tmp/NodeGoat/app/data/benefits-dao.js", "/Users/ibrahim/Developer/unifonic/DataBug/tmp/NodeGoat/app/data/contributions-dao.js", "/Users/ibrahim/Developer/unifonic/DataBug/tmp/NodeGoat/app/data/memos-dao.js", "/Users/ibrahim/Developer/unifonic/DataBug/tmp/NodeGoat/app/data/profile-dao.js", "/Users/ibrahim/Developer/unifonic/DataBug/tmp/NodeGoat/app/data/research-dao.js", "/Users/ibrahim/Developer/unifonic/DataBug/tmp/NodeGoat/app/data/user-dao.js", "/Users/ibrahim/Developer/unifonic/DataBug/tmp/NodeGoat/app/routes/allocations.js", "/Users/ibrahim/Developer/unifonic/DataBug/tmp/NodeGoat/app/routes/benefits.js", "/Users/ibrahim/Developer/unifonic/DataBug/tmp/NodeGoat/app/routes/contributions.js", "/Users/ibrahim/Developer/unifonic/DataBug/tmp/NodeGoat/app/routes/error.js", "/Users/ibrahim/Developer/unifonic/DataBug/tmp/NodeGoat/app/routes/index.js", "/Users/ibrahim/Developer/unifonic/DataBug/tmp/NodeGoat/app/routes/memos.js", "/Users/ibrahim/Developer/unifonic/DataBug/tmp/NodeGoat/app/routes/profile.js", "/Users/ibrahim/Developer/unifonic/DataBug/tmp/NodeGoat/app/routes/research.js", "/Users/ibrahim/Developer/unifonic/DataBug/tmp/NodeGoat/app/routes/session.js", "/Users/ibrahim/Developer/unifonic/DataBug/tmp/NodeGoat/app/routes/tutorial.js", "/Users/ibrahim/Developer/unifonic/DataBug/tmp/NodeGoat/artifacts/db-reset.js", "/Users/ibrahim/Developer/unifonic/DataBug/tmp/NodeGoat/config/config.js", "/Users/ibrahim/Developer/unifonic/DataBug/tmp/NodeGoat/config/env/all.js", "/Users/ibrahim/Developer/unifonic/DataBug/tmp/NodeGoat/config/env/development.js", "/Users/ibrahim/Developer/unifonic/DataBug/tmp/NodeGoat/config/env/production.js", "/Users/ibrahim/Developer/unifonic/DataBug/tmp/NodeGoat/config/env/test.js", "/Users/ibrahim/Developer/unifonic/DataBug/tmp/NodeGoat/server.js"]}, "results": [{"check_id": "javascript.lang.security.audit.code-string-concat.code-string-concat", "end": {"col": 45, "line": 32, "offset": 955}, "extra": {"dataflow_trace": {"intermediate_vars": [], "taint_sink": ["CliLoc", [{"end": {"col": 45, "line": 32, "offset": 955}, "path": "/Users/ibrahim/Developer/unifonic/DataBug/tmp/NodeGoat/app/routes/contributions.js", "start": {"col": 24, "line": 32, "offset": 934}}, "eval(req.body.preTax)"]], "taint_source": ["CliLoc", [{"end": {"col": 37, "line": 32, "offset": 947}, "path": "/Users/ibrahim/Developer/unifonic/DataBug/tmp/NodeGoat/app/routes/contributions.js", "start": {"col": 29, "line": 32, "offset": 939}}, "req.body"]]}, "engine_kind": "OSS", "fingerprint": "2e3bac87f207f65cac4bbbbb274ca14bf317ead5a183a780304c5bc538fe7b5b2ae99143022929535e3c59cf5aeac52c1478446a428bbfffb7e1b7b1b4089da4_0", "is_ignored": false, "lines": "        const preTax = eval(req.body.preTax);", "message": "Found data from an Express or Next web request flowing to `eval`. If this data is user-controllable this can lead to execution of arbitrary system commands in the context of your application process. Avoid `eval` whenever possible.", "metadata": {"category": "security", "confidence": "HIGH", "cwe": ["CWE-95: Improper Neutralization of Directives in Dynamically Evaluated Code ('Eval Injection')"], "impact": "MEDIUM", "interfile": true, "license": "Semgrep Rules License v1.0. For more details, visit semgrep.dev/legal/rules-license", "likelihood": "MEDIUM", "owasp": ["A03:2021 - Injection", "A05:2025 - Injection"], "references": ["https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/eval", "https://nodejs.org/api/child_process.html#child_processexeccommand-options-callback", "https://www.stackhawk.com/blog/nodejs-command-injection-examples-and-prevention/", "https://ckarande.gitbooks.io/owasp-nodegoat-tutorial/content/tutorial/a1_-_server_side_js_injection.html"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 13023, "rule_id": "DbUKEz", "rv_id": 1263192, "url": "https://semgrep.dev/playground/r/44TEjYX/javascript.lang.security.audit.code-string-concat.code-string-concat", "version_id": "44TEjYX"}}, "shortlink": "https://sg.run/96Yk", "source": "https://semgrep.dev/r/javascript.lang.security.audit.code-string-concat.code-string-concat", "subcategory": ["vuln"], "technology": ["node.js", "Express", "Next.js"], "vulnerability_class": ["Code Injection"]}, "metavars": {"$NEXT": {"abstract_content": "next", "end": {"col": 53, "line": 28, "offset": 822}, "start": {"col": 49, "line": 28, "offset": 818}}, "$REQ": {"abstract_content": "req", "end": {"col": 32, "line": 32, "offset": 942}, "start": {"col": 29, "line": 32, "offset": 939}}, "$RES": {"abstract_content": "res", "end": {"col": 47, "line": 28, "offset": 816}, "start": {"col": 44, "line": 28, "offset": 813}}}, "severity": "ERROR", "validation_state": "NO_VALIDATOR"}, "path": "/Users/ibrahim/Developer/unifonic/DataBug/tmp/NodeGoat/app/routes/contributions.js", "start": {"col": 24, "line": 32, "offset": 934}}, {"check_id": "javascript.lang.security.audit.code-string-concat.code-string-concat", "end": {"col": 49, "line": 33, "offset": 1005}, "extra": {"dataflow_trace": {"intermediate_vars": [], "taint_sink": ["CliLoc", [{"end": {"col": 49, "line": 33, "offset": 1005}, "path": "/Users/ibrahim/Developer/unifonic/DataBug/tmp/NodeGoat/app/routes/contributions.js", "start": {"col": 26, "line": 33, "offset": 982}}, "eval(req.body.afterTax)"]], "taint_source": ["CliLoc", [{"end": {"col": 39, "line": 33, "offset": 995}, "path": "/Users/ibrahim/Developer/unifonic/DataBug/tmp/NodeGoat/app/routes/contributions.js", "start": {"col": 31, "line": 33, "offset": 987}}, "req.body"]]}, "engine_kind": "OSS", "fingerprint": "2e3bac87f207f65cac4bbbbb274ca14bf317ead5a183a780304c5bc538fe7b5b2ae99143022929535e3c59cf5aeac52c1478446a428bbfffb7e1b7b1b4089da4_1", "is_ignored": false, "lines": "        const afterTax = eval(req.body.afterTax);", "message": "Found data from an Express or Next web request flowing to `eval`. If this data is user-controllable this can lead to execution of arbitrary system commands in the context of your application process. Avoid `eval` whenever possible.", "metadata": {"category": "security", "confidence": "HIGH", "cwe": ["CWE-95: Improper Neutralization of Directives in Dynamically Evaluated Code ('Eval Injection')"], "impact": "MEDIUM", "interfile": true, "license": "Semgrep Rules License v1.0. For more details, visit semgrep.dev/legal/rules-license", "likelihood": "MEDIUM", "owasp": ["A03:2021 - Injection", "A05:2025 - Injection"], "references": ["https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/eval", "https://nodejs.org/api/child_process.html#child_processexeccommand-options-callback", "https://www.stackhawk.com/blog/nodejs-command-injection-examples-and-prevention/", "https://ckarande.gitbooks.io/owasp-nodegoat-tutorial/content/tutorial/a1_-_server_side_js_injection.html"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 13023, "rule_id": "DbUKEz", "rv_id": 1263192, "url": "https://semgrep.dev/playground/r/44TEjYX/javascript.lang.security.audit.code-string-concat.code-string-concat", "version_id": "44TEjYX"}}, "shortlink": "https://sg.run/96Yk", "source": "https://semgrep.dev/r/javascript.lang.security.audit.code-string-concat.code-string-concat", "subcategory": ["vuln"], "technology": ["node.js", "Express", "Next.js"], "vulnerability_class": ["Code Injection"]}, "metavars": {"$NEXT": {"abstract_content": "next", "end": {"col": 53, "line": 28, "offset": 822}, "start": {"col": 49, "line": 28, "offset": 818}}, "$REQ": {"abstract_content": "req", "end": {"col": 34, "line": 33, "offset": 990}, "start": {"col": 31, "line": 33, "offset": 987}}, "$RES": {"abstract_content": "res", "end": {"col": 47, "line": 28, "offset": 816}, "start": {"col": 44, "line": 28, "offset": 813}}}, "severity": "ERROR", "validation_state": "NO_VALIDATOR"}, "path": "/Users/ibrahim/Developer/unifonic/DataBug/tmp/NodeGoat/app/routes/contributions.js", "start": {"col": 26, "line": 33, "offset": 982}}, {"check_id": "javascript.lang.security.audit.code-string-concat.code-string-concat", "end": {"col": 41, "line": 34, "offset": 1047}, "extra": {"dataflow_trace": {"intermediate_vars": [], "taint_sink": ["CliLoc", [{"end": {"col": 41, "line": 34, "offset": 1047}, "path": "/Users/ibrahim/Developer/unifonic/DataBug/tmp/NodeGoat/app/routes/contributions.js", "start": {"col": 22, "line": 34, "offset": 1028}}, "eval(req.body.roth)"]], "taint_source": ["CliLoc", [{"end": {"col": 35, "line": 34, "offset": 1041}, "path": "/Users/ibrahim/Developer/unifonic/DataBug/tmp/NodeGoat/app/routes/contributions.js", "start": {"col": 27, "line": 34, "offset": 1033}}, "req.body"]]}, "engine_kind": "OSS", "fingerprint": "2e3bac87f207f65cac4bbbbb274ca14bf317ead5a183a780304c5bc538fe7b5b2ae99143022929535e3c59cf5aeac52c1478446a428bbfffb7e1b7b1b4089da4_2", "is_ignored": false, "lines": "        const roth = eval(req.body.roth);", "message": "Found data from an Express or Next web request flowing to `eval`. If this data is user-controllable this can lead to execution of arbitrary system commands in the context of your application process. Avoid `eval` whenever possible.", "metadata": {"category": "security", "confidence": "HIGH", "cwe": ["CWE-95: Improper Neutralization of Directives in Dynamically Evaluated Code ('Eval Injection')"], "impact": "MEDIUM", "interfile": true, "license": "Semgrep Rules License v1.0. For more details, visit semgrep.dev/legal/rules-license", "likelihood": "MEDIUM", "owasp": ["A03:2021 - Injection", "A05:2025 - Injection"], "references": ["https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/eval", "https://nodejs.org/api/child_process.html#child_processexeccommand-options-callback", "https://www.stackhawk.com/blog/nodejs-command-injection-examples-and-prevention/", "https://ckarande.gitbooks.io/owasp-nodegoat-tutorial/content/tutorial/a1_-_server_side_js_injection.html"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 13023, "rule_id": "DbUKEz", "rv_id": 1263192, "url": "https://semgrep.dev/playground/r/44TEjYX/javascript.lang.security.audit.code-string-concat.code-string-concat", "version_id": "44TEjYX"}}, "shortlink": "https://sg.run/96Yk", "source": "https://semgrep.dev/r/javascript.lang.security.audit.code-string-concat.code-string-concat", "subcategory": ["vuln"], "technology": ["node.js", "Express", "Next.js"], "vulnerability_class": ["Code Injection"]}, "metavars": {"$NEXT": {"abstract_content": "next", "end": {"col": 53, "line": 28, "offset": 822}, "start": {"col": 49, "line": 28, "offset": 818}}, "$REQ": {"abstract_content": "req", "end": {"col": 30, "line": 34, "offset": 1036}, "start": {"col": 27, "line": 34, "offset": 1033}}, "$RES": {"abstract_content": "res", "end": {"col": 47, "line": 28, "offset": 816}, "start": {"col": 44, "line": 28, "offset": 813}}}, "severity": "ERROR", "validation_state": "NO_VALIDATOR"}, "path": "/Users/ibrahim/Developer/unifonic/DataBug/tmp/NodeGoat/app/routes/contributions.js", "start": {"col": 22, "line": 34, "offset": 1028}}, {"check_id": "javascript.express.security.audit.express-open-redirect.express-open-redirect", "end": {"col": 42, "line": 72, "offset": 2884}, "extra": {"dataflow_trace": {"intermediate_vars": [], "taint_sink": ["CliLoc", [{"end": {"col": 42, "line": 72, "offset": 2884}, "path": "/Users/ibrahim/Developer/unifonic/DataBug/tmp/NodeGoat/app/routes/index.js", "start": {"col": 29, "line": 72, "offset": 2871}}, "req.query.url"]], "taint_source": ["CliLoc", [{"end": {"col": 38, "line": 72, "offset": 2880}, "path": "/Users/ibrahim/Developer/unifonic/DataBug/tmp/NodeGoat/app/routes/index.js", "start": {"col": 29, "line": 72, "offset": 2871}}, "req.query"]]}, "engine_kind": "OSS", "fingerprint": "51ce5ba9d5f3da5bc4917f7936baf8f63164764b8388dee740f7951cb67e924a8261ac767bfa0f3c5107de3bdd99402c607719f97b5ea4fc9fc8523aa9a5703f_0", "is_ignored": false, "lines": "        return res.redirect(req.query.url);", "message": "The application redirects to a URL specified by user-supplied input `req` that is not validated. This could redirect users to malicious locations. Consider using an allow-list approach to validate URLs, or warn users they are being redirected to a third-party website.", "metadata": {"category": "security", "confidence": "HIGH", "cwe": ["CWE-601: URL Redirection to Untrusted Site ('Open Redirect')"], "impact": "MEDIUM", "license": "Semgrep Rules License v1.0. For more details, visit semgrep.dev/legal/rules-license", "likelihood": "HIGH", "owasp": ["A01:2021 - Broken Access Control", "A01:2025 - Broken Access Control"], "references": ["https://cheatsheetseries.owasp.org/cheatsheets/Unvalidated_Redirects_and_Forwards_Cheat_Sheet.html"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 22081, "rule_id": "X5ULkq", "rv_id": 1263140, "url": "https://semgrep.dev/playground/r/nWT2L0v/javascript.express.security.audit.express-open-redirect.express-open-redirect", "version_id": "nWT2L0v"}}, "shortlink": "https://sg.run/EpoP", "source": "https://semgrep.dev/r/javascript.express.security.audit.express-open-redirect.express-open-redirect", "subcategory": ["vuln"], "technology": ["express"], "vulnerability_class": ["Open Redirect"]}, "metavars": {"$1": {"abstract_content": "get", "end": {"col": 4, "line": 1, "offset": 3}, "start": {"col": 1, "line": 1, "offset": 0}}, "$APP": {"abstract_content": "app", "end": {"col": 8, "line": 70, "offset": 2715}, "start": {"col": 5, "line": 70, "offset": 2712}}, "$METHOD": {"abstract_content": "get", "end": {"col": 12, "line": 70, "offset": 2719}, "start": {"col": 9, "line": 70, "offset": 2716}}, "$REQ": {"abstract_content": "req", "end": {"col": 32, "line": 72, "offset": 2874}, "start": {"col": 29, "line": 72, "offset": 2871}}, "$RES": {"abstract_content": "res", "end": {"col": 19, "line": 72, "offset": 2861}, "start": {"col": 16, "line": 72, "offset": 2858}}, "$VALUE": {"abstract_content": "url", "end": {"col": 42, "line": 72, "offset": 2884}, "start": {"col": 39, "line": 72, "offset": 2881}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "/Users/ibrahim/Developer/unifonic/DataBug/tmp/NodeGoat/app/routes/index.js", "start": {"col": 29, "line": 72, "offset": 2871}}, {"check_id": "javascript.express.security.audit.express-cookie-settings.express-cookie-session-default-name", "end": {"col": 7, "line": 102, "offset": 3439}, "extra": {"engine_kind": "OSS", "fingerprint": "e07b4207cf8fb301d76713c0da751c630b23a84004ae132c40d775fb5f3ed15f7abdfcc8b587c3d8b3fb1a5c35df0404cbe558de325b720e00789ee34fecd5d5_0", "is_ignored": false, "lines": "    app.use(session({\n        // genid: (req) => {\n        //    return genuuid() // use UUIDs for session IDs\n        //},\n        secret: cookieSecret,\n        // Both mandatory in Express v4\n        saveUninitialized: true,\n        resave: true\n        /*\n        // Fix for A5 - Security MisConfig\n        // Use generic cookie name\n        key: \"sessionId\",\n        */\n\n        /*\n        // Fix for A3 - XSS\n        // TODO: Add \"maxAge\"\n        cookie: {\n            httpOnly: true\n            // Remember to start an HTTPS server to get this working\n            // secure: true\n        }\n        */\n\n    }));", "message": "Don\u2019t use the default session cookie name Using the default session cookie name can open your app to attacks. The security issue posed is similar to X-Powered-By: a potential attacker can use it to fingerprint the server and target attacks accordingly.", "metadata": {"category": "security", "confidence": "MEDIUM", "cwe": ["CWE-522: Insufficiently Protected Credentials"], "cwe2021-top25": true, "impact": "LOW", "license": "Semgrep Rules License v1.0. For more details, visit semgrep.dev/legal/rules-license", "likelihood": "HIGH", "owasp": ["A02:2017 - Broken Authentication", "A04:2021 - Insecure Design", "A06:2025 - Insecure Design"], "references": ["https://owasp.org/Top10/A04_2021-Insecure_Design"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 9266, "rule_id": "eqU8k2", "rv_id": 1263130, "url": "https://semgrep.dev/playground/r/bZT536J/javascript.express.security.audit.express-cookie-settings.express-cookie-session-default-name", "version_id": "bZT536J"}}, "shortlink": "https://sg.run/1Z5x", "source": "https://semgrep.dev/r/javascript.express.security.audit.express-cookie-settings.express-cookie-session-default-name", "source-rule-url": "https://expressjs.com/en/advanced/best-practice-security.html", "subcategory": ["vuln"], "technology": ["express"], "vulnerability_class": ["Cryptographic Issues"]}, "metavars": {"$SESSION": {"abstract_content": "session", "end": {"col": 20, "line": 78, "offset": 2844}, "start": {"col": 13, "line": 78, "offset": 2837}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "/Users/ibrahim/Developer/unifonic/DataBug/tmp/NodeGoat/server.js", "start": {"col": 13, "line": 78, "offset": 2837}}, {"check_id": "javascript.express.security.audit.express-cookie-settings.express-cookie-session-no-domain", "end": {"col": 7, "line": 102, "offset": 3439}, "extra": {"engine_kind": "OSS", "fingerprint": "5eff7ffc4df7953f149f2296e6a6cf54b38e90babd17537f1cd5669ba6410ee687171b4c42150e41cab5bd3ff3606b7cba9e84052f39626b6e5ab3b0b6220eb7_0", "is_ignored": false, "lines": "    app.use(session({\n        // genid: (req) => {\n        //    return genuuid() // use UUIDs for session IDs\n        //},\n        secret: cookieSecret,\n        // Both mandatory in Express v4\n        saveUninitialized: true,\n        resave: true\n        /*\n        // Fix for A5 - Security MisConfig\n        // Use generic cookie name\n        key: \"sessionId\",\n        */\n\n        /*\n        // Fix for A3 - XSS\n        // TODO: Add \"maxAge\"\n        cookie: {\n            httpOnly: true\n            // Remember to start an HTTPS server to get this working\n            // secure: true\n        }\n        */\n\n    }));", "message": "Default session middleware settings: `domain` not set. It indicates the domain of the cookie; use it to compare against the domain of the server in which the URL is being requested. If they match, then check the path attribute next.", "metadata": {"category": "security", "confidence": "MEDIUM", "cwe": ["CWE-522: Insufficiently Protected Credentials"], "cwe2021-top25": true, "impact": "LOW", "license": "Semgrep Rules License v1.0. For more details, visit semgrep.dev/legal/rules-license", "likelihood": "HIGH", "owasp": ["A02:2017 - Broken Authentication", "A04:2021 - Insecure Design", "A06:2025 - Insecure Design"], "references": ["https://owasp.org/Top10/A04_2021-Insecure_Design"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 9269, "rule_id": "ZqU5Pn", "rv_id": 1263133, "url": "https://semgrep.dev/playground/r/w8TRoyd/javascript.express.security.audit.express-cookie-settings.express-cookie-session-no-domain", "version_id": "w8TRoyd"}}, "shortlink": "https://sg.run/rd41", "source": "https://semgrep.dev/r/javascript.express.security.audit.express-cookie-settings.express-cookie-session-no-domain", "source-rule-url": "https://expressjs.com/en/advanced/best-practice-security.html", "subcategory": ["vuln"], "technology": ["express"], "vulnerability_class": ["Cryptographic Issues"]}, "metavars": {"$SESSION": {"abstract_content": "session", "end": {"col": 20, "line": 78, "offset": 2844}, "start": {"col": 13, "line": 78, "offset": 2837}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "/Users/ibrahim/Developer/unifonic/DataBug/tmp/NodeGoat/server.js", "start": {"col": 13, "line": 78, "offset": 2837}}, {"check_id": "javascript.express.security.audit.express-cookie-settings.express-cookie-session-no-expires", "end": {"col": 7, "line": 102, "offset": 3439}, "extra": {"engine_kind": "OSS", "fingerprint": "e6bd8bf263e45cffddba773409383530eed514985494903ff70902b3d7a1b2c27b5127bfca6dfcb71c7ae3aa30bc0cda8f3cba847739a3d92df32f2e3ebbd00d_0", "is_ignored": false, "lines": "    app.use(session({\n        // genid: (req) => {\n        //    return genuuid() // use UUIDs for session IDs\n        //},\n        secret: cookieSecret,\n        // Both mandatory in Express v4\n        saveUninitialized: true,\n        resave: true\n        /*\n        // Fix for A5 - Security MisConfig\n        // Use generic cookie name\n        key: \"sessionId\",\n        */\n\n        /*\n        // Fix for A3 - XSS\n        // TODO: Add \"maxAge\"\n        cookie: {\n            httpOnly: true\n            // Remember to start an HTTPS server to get this working\n            // secure: true\n        }\n        */\n\n    }));", "message": "Default session middleware settings: `expires` not set. Use it to set expiration date for persistent cookies.", "metadata": {"category": "security", "confidence": "MEDIUM", "cwe": ["CWE-522: Insufficiently Protected Credentials"], "cwe2021-top25": true, "impact": "LOW", "license": "Semgrep Rules License v1.0. For more details, visit semgrep.dev/legal/rules-license", "likelihood": "HIGH", "owasp": ["A02:2017 - Broken Authentication", "A04:2021 - Insecure Design", "A06:2025 - Insecure Design"], "references": ["https://owasp.org/Top10/A04_2021-Insecure_Design"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 9271, "rule_id": "EwU2DZ", "rv_id": 1263135, "url": "https://semgrep.dev/playground/r/O9TpxRq/javascript.express.security.audit.express-cookie-settings.express-cookie-session-no-expires", "version_id": "O9TpxRq"}}, "shortlink": "https://sg.run/N4eG", "source": "https://semgrep.dev/r/javascript.express.security.audit.express-cookie-settings.express-cookie-session-no-expires", "source-rule-url": "https://expressjs.com/en/advanced/best-practice-security.html", "subcategory": ["vuln"], "technology": ["express"], "vulnerability_class": ["Cryptographic Issues"]}, "metavars": {"$SESSION": {"abstract_content": "session", "end": {"col": 20, "line": 78, "offset": 2844}, "start": {"col": 13, "line": 78, "offset": 2837}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "/Users/ibrahim/Developer/unifonic/DataBug/tmp/NodeGoat/server.js", "start": {"col": 13, "line": 78, "offset": 2837}}, {"check_id": "javascript.express.security.audit.express-cookie-settings.express-cookie-session-no-httponly", "end": {"col": 7, "line": 102, "offset": 3439}, "extra": {"engine_kind": "OSS", "fingerprint": "f50db20b56bb2d4041afa5d725bdfd1d8b4662b43f94daff6b5306e01ecaf43d2aa64f94ce29af1f1633fe8b16d01cb6fdb70bb7fd364a4f5c744c8b87c6be0d_0", "is_ignored": false, "lines": "    app.use(session({\n        // genid: (req) => {\n        //    return genuuid() // use UUIDs for session IDs\n        //},\n        secret: cookieSecret,\n        // Both mandatory in Express v4\n        saveUninitialized: true,\n        resave: true\n        /*\n        // Fix for A5 - Security MisConfig\n        // Use generic cookie name\n        key: \"sessionId\",\n        */\n\n        /*\n        // Fix for A3 - XSS\n        // TODO: Add \"maxAge\"\n        cookie: {\n            httpOnly: true\n            // Remember to start an HTTPS server to get this working\n            // secure: true\n        }\n        */\n\n    }));", "message": "Default session middleware settings: `httpOnly` not set. It ensures the cookie is sent only over HTTP(S), not client JavaScript, helping to protect against cross-site scripting attacks.", "metadata": {"category": "security", "confidence": "MEDIUM", "cwe": ["CWE-522: Insufficiently Protected Credentials"], "cwe2021-top25": true, "impact": "LOW", "license": "Semgrep Rules License v1.0. For more details, visit semgrep.dev/legal/rules-license", "likelihood": "HIGH", "owasp": ["A02:2017 - Broken Authentication", "A04:2021 - Insecure Design", "A06:2025 - Insecure Design"], "references": ["https://owasp.org/Top10/A04_2021-Insecure_Design"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 9268, "rule_id": "d8UjGo", "rv_id": 1263132, "url": "https://semgrep.dev/playground/r/kbTzGev/javascript.express.security.audit.express-cookie-settings.express-cookie-session-no-httponly", "version_id": "kbTzGev"}}, "shortlink": "https://sg.run/ydBO", "source": "https://semgrep.dev/r/javascript.express.security.audit.express-cookie-settings.express-cookie-session-no-httponly", "source-rule-url": "https://expressjs.com/en/advanced/best-practice-security.html", "subcategory": ["vuln"], "technology": ["express"], "vulnerability_class": ["Cryptographic Issues"]}, "metavars": {"$SESSION": {"abstract_content": "session", "end": {"col": 20, "line": 78, "offset": 2844}, "start": {"col": 13, "line": 78, "offset": 2837}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "/Users/ibrahim/Developer/unifonic/DataBug/tmp/NodeGoat/server.js", "start": {"col": 13, "line": 78, "offset": 2837}}, {"check_id": "javascript.express.security.audit.express-cookie-settings.express-cookie-session-no-path", "end": {"col": 7, "line": 102, "offset": 3439}, "extra": {"engine_kind": "OSS", "fingerprint": "23044fcfe6f0fc4b9d92b18665fd64942fa2bc7b4763d78e236c9979893430b510e6b684539789f0a03b54f5a4bfff7f48ea8b81c6b61a8b2a8acc346d765db1_0", "is_ignored": false, "lines": "    app.use(session({\n        // genid: (req) => {\n        //    return genuuid() // use UUIDs for session IDs\n        //},\n        secret: cookieSecret,\n        // Both mandatory in Express v4\n        saveUninitialized: true,\n        resave: true\n        /*\n        // Fix for A5 - Security MisConfig\n        // Use generic cookie name\n        key: \"sessionId\",\n        */\n\n        /*\n        // Fix for A3 - XSS\n        // TODO: Add \"maxAge\"\n        cookie: {\n            httpOnly: true\n            // Remember to start an HTTPS server to get this working\n            // secure: true\n        }\n        */\n\n    }));", "message": "Default session middleware settings: `path` not set. It indicates the path of the cookie; use it to compare against the request path. If this and domain match, then send the cookie in the request.", "metadata": {"category": "security", "confidence": "MEDIUM", "cwe": ["CWE-522: Insufficiently Protected Credentials"], "cwe2021-top25": true, "impact": "LOW", "license": "Semgrep Rules License v1.0. For more details, visit semgrep.dev/legal/rules-license", "likelihood": "HIGH", "owasp": ["A02:2017 - Broken Authentication", "A04:2021 - Insecure Design", "A06:2025 - Insecure Design"], "references": ["https://owasp.org/Top10/A04_2021-Insecure_Design"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 9270, "rule_id": "nJUz4X", "rv_id": 1263134, "url": "https://semgrep.dev/playground/r/xyTjzQD/javascript.express.security.audit.express-cookie-settings.express-cookie-session-no-path", "version_id": "xyTjzQD"}}, "shortlink": "https://sg.run/b7pd", "source": "https://semgrep.dev/r/javascript.express.security.audit.express-cookie-settings.express-cookie-session-no-path", "source-rule-url": "https://expressjs.com/en/advanced/best-practice-security.html", "subcategory": ["vuln"], "technology": ["express"], "vulnerability_class": ["Cryptographic Issues"]}, "metavars": {"$SESSION": {"abstract_content": "session", "end": {"col": 20, "line": 78, "offset": 2844}, "start": {"col": 13, "line": 78, "offset": 2837}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "/Users/ibrahim/Developer/unifonic/DataBug/tmp/NodeGoat/server.js", "start": {"col": 13, "line": 78, "offset": 2837}}, {"check_id": "javascript.express.security.audit.express-cookie-settings.express-cookie-session-no-secure", "end": {"col": 7, "line": 102, "offset": 3439}, "extra": {"engine_kind": "OSS", "fingerprint": "e4e3830961a2a9ee5cb64198b66c0bde2df89e824065831d9ce16a966b2e727430040b0b2c22ac223889a5543d5ac15b60e61e10f0d19b3470d354de53232337_0", "is_ignored": false, "lines": "    app.use(session({\n        // genid: (req) => {\n        //    return genuuid() // use UUIDs for session IDs\n        //},\n        secret: cookieSecret,\n        // Both mandatory in Express v4\n        saveUninitialized: true,\n        resave: true\n        /*\n        // Fix for A5 - Security MisConfig\n        // Use generic cookie name\n        key: \"sessionId\",\n        */\n\n        /*\n        // Fix for A3 - XSS\n        // TODO: Add \"maxAge\"\n        cookie: {\n            httpOnly: true\n            // Remember to start an HTTPS server to get this working\n            // secure: true\n        }\n        */\n\n    }));", "message": "Default session middleware settings: `secure` not set. It ensures the browser only sends the cookie over HTTPS.", "metadata": {"category": "security", "confidence": "MEDIUM", "cwe": ["CWE-522: Insufficiently Protected Credentials"], "cwe2021-top25": true, "impact": "LOW", "license": "Semgrep Rules License v1.0. For more details, visit semgrep.dev/legal/rules-license", "likelihood": "HIGH", "owasp": ["A02:2017 - Broken Authentication", "A04:2021 - Insecure Design", "A06:2025 - Insecure Design"], "references": ["https://owasp.org/Top10/A04_2021-Insecure_Design"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 9267, "rule_id": "v8Unzw", "rv_id": 1263131, "url": "https://semgrep.dev/playground/r/NdTzyrv/javascript.express.security.audit.express-cookie-settings.express-cookie-session-no-secure", "version_id": "NdTzyrv"}}, "shortlink": "https://sg.run/9oKz", "source": "https://semgrep.dev/r/javascript.express.security.audit.express-cookie-settings.express-cookie-session-no-secure", "source-rule-url": "https://expressjs.com/en/advanced/best-practice-security.html", "subcategory": ["vuln"], "technology": ["express"], "vulnerability_class": ["Cryptographic Issues"]}, "metavars": {"$SESSION": {"abstract_content": "session", "end": {"col": 20, "line": 78, "offset": 2844}, "start": {"col": 13, "line": 78, "offset": 2837}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "/Users/ibrahim/Developer/unifonic/DataBug/tmp/NodeGoat/server.js", "start": {"col": 13, "line": 78, "offset": 2837}}], "skipped_rules": [], "version": "1.52.0"}
